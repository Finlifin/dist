import{_ as R,h as k,k as B,i as C,o as D,y as E,u as A,r as l,j as O,a as K,b as L,d as s,w as P,v as q,s as z,n as h,E as i,p as N,g as T}from"./index-cc055007.js";const U="/assets/头像1-f8fdd468.jpg",V="/assets/头像2-0adb3e67.jpg",J="/assets/头像3-df6f3fbf.jpg",Z="/assets/头像4-3c0c45ef.jpg",$="/assets/头像5-f2455274.jpg",F="/assets/头像6-ba65e076.jpg",G="/assets/头像7-d4e7d3e9.jpg",H="/assets/头像8-20cf6c28.jpg",Q="/assets/头像9-d36e5684.jpg",W="/assets/头像10-d9d2c460.jpg";const X=n=>(N("data-v-65f26f25"),n=n(),T(),n),Y={style:{position:"relative"}},ee={class:"view"},ae=["src"],te=X(()=>s("p",null,"点击可以ROLL不同头像哦~",-1)),se=["onKeydown"],oe={__name:"SignIn",setup(n){k();const S=B(),{data:ne,setShow:b}=C("isShow");b(S.meta.isShow),D(()=>{if(o.value=localStorage.getItem("username"),o.value){v.push("/chatRoom");return}});const I=E.create({baseURL:"",timeout:3e3,withCredentials:!0}),d=A(),y=l(""),o=l(""),m=l(""),v=O(),w=/^[\u4e00-\u9fa5a-zA-Z0-9]{2,8}$/;function j(t,e){return t.test(e)}function p(t){t.preventDefault();const e=o.value.trim(),c=u[r].number;if(!j(w,e)){m.value="请输入正确的用户名,应该是2-8个英文,中文,或者数字的组合,不要有符号!!!",i({type:"error",message:m,duration:5e3});return}localStorage.setItem("username",e),localStorage.setItem("avatarSelected",c),d.avatarSelected=c,y.value="",d.username=e,o.value="";let M={name:localStorage.getItem("username"),avatarSelected:localStorage.getItem("avatarSelected")};I.post("/login",M).then(a=>{console.log(a),a.data.statuts=="sucessed"?(localStorage.setItem("username",a.data.name),localStorage.setItem("avatarSelected",a.data.avatarSelected),localStorage.setItem("ID",a.data.id),setTimeout(()=>{v.push("/chatRoom")},500)):a.data.statuts=="failedAtDuplicationOfName"&&i({type:"error",message:"你取得用户名和别人重名了",duration:2e3})}).catch(a=>{console.log(a),a.message=="Request failed with status code 500"?i({type:"error",message:"服务器响应失败!!!",duration:3e3}):a.message=="timeout of 3000ms exceeded"&&i({type:"error",message:"服务器响应时间过长,失败!!!",duration:3e3})})}const u=[{avatar:U,number:"0"},{avatar:V,number:"1"},{avatar:J,number:"2"},{avatar:Z,number:"3"},{avatar:$,number:"4"},{avatar:F,number:"5"},{avatar:G,number:"6"},{avatar:H,number:"7"},{avatar:Q,number:"8"},{avatar:W,number:"9"}],g=t=>Math.floor(Math.random()*t);let r=g(10);const f=l(u[r].avatar),x=()=>{r=g(10),f.value=u[r].avatar};function _(t){let e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(e&&t==1)return{height:"80vh"};if(e&&t==2)return{"margin-bottom":"150px"}}return(t,e)=>(K(),L("div",{class:"allin",style:h(_(1))},[s("form",{style:h(_(2))},[s("div",Y,[s("div",ee,[s("img",{class:"preview",ref:"preview",onClick:x,src:f.value},null,8,ae)]),te]),P(s("input",{class:"name",type:"text",name:"userID","onUpdate:modelValue":e[0]||(e[0]=c=>o.value=c),placeholder:"在这里设置你的聊天室ID😎",onKeydown:z(p,["enter"])},null,40,se),[[q,o.value]]),s("button",{class:"btn",type:"submit",onClick:p}," ✨加入聊天室✨ ")],4)],4))}},ce=R(oe,[["__scopeId","data-v-65f26f25"]]);export{ce as default};
